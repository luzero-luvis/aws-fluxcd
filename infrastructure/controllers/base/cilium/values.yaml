# Cilium 1.18.2 Configuration for AWS EKS
# Install:
# helm install cilium cilium/cilium --version 1.18.2 -f cilium-values.yaml -n kube-system

# Disable ENI IPAM (let Cilium manage pod IPs)
eni:
  enabled: false

# Cluster-pool IPAM (Cilium-managed pod IPs)
ipam:
  mode: cluster-pool
  operator:
    clusterPoolIPv4PodCIDRList:
      - "10.244.0.0/16"   # total pod IP range for cluster
    clusterPoolIPv4MaskSize: 24  # each node gets /24 (256 IPs)

# Overlay network (VXLAN)
routingMode: tunnel
tunnel: vxlan

# Masquerade outbound traffic
egressMasqueradeInterfaces: eth0

# Enable endpoint routes
endpointRoutes:
  enabled: true

# Replace kube-proxy
kubeProxyReplacement: true

# Kubernetes API Server Configuration
k8sServiceHost: "70F5A1222EC56EB5FA79F50318312C99.gr7.us-west-2.eks.amazonaws.com"
k8sServicePort: "443"

# Prometheus Metrics
prometheus:
  enabled: true

# Operator Configuration
operator:
  prometheus:
    enabled: true

# Hubble Observability
hubble:
  enabled: true
  relay:
    enabled: true
  ui:
    enabled: true
  metrics:
    enabled:
      - dns
      - drop
      - tcp
      - flow
      - port-distribution
      - icmp
      - "httpV2:exemplars=true;labelsContext=source_ip,source_namespace,source_workload,destination_ip,destination_namespace,destination_workload,traffic_direction"

